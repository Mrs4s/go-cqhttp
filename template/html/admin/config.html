{{ template "admin/main.html"}}

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    {{/*<section class="content-header">*/}}
    {{/*<h1>*/}}
    {{/*用户中心*/}}
    {{/*<small>User Center</small>*/}}
    {{/*</h1>*/}}
    {{/*</section>*/}}
    <!-- Main content -->
    <section class="content">
        <!-- START PROGRESS BARS -->
        <div class="row">
            <div class="col-md-12">
                <div style="margin: 0 auto; max-width: 400px;">
                    <ol class="breadcrumb">
                        <li><a href="/admin/index">管理</a></li>
                        <li class="active">简易配置</li>
                    </ol>

                    <div class="panel panel-default">
                        <div class="alert1"></div>
                        <div class="panel-heading">
                            <h3 class="panel-title">账号配置 </h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="uin">QQ（uin）：</label> <input
                                        type="text" name="uin" id="uin" class="form-control"
                                        value="{{getConf.Uin}}" />
                            </div>
                            <div class="form-group">
                                <label for="password">密码（password）：</label> <input type="password" name="password"
                                                                      id="password" class="form-control" value="{{getConf.Password}}" />
                            </div>
                            <div class="form-group">
                                <label for="enable_db" class="form-check-label" >enable_db：</label>
                                <input type="checkbox" name="enable_db" id="enable_db" class="form-check-input" {{if getConf.EnableDB }} checked {{end}}/>
                            </div>
                            <div class="form-group">
                                <label for="access_token">access_token：</label> <input
                                        type="text" name="access_token" id="access_token" class="form-control"
                                        value="{{getConf.AccessToken}}" />
                            </div>
                            <div class="form-group">
                                <label for="post_message_format">post_message_format：</label>
                                <input type="text" name="post_message_format" id="post_message_format"
                                                                     class="form-control" value="{{getConf.PostMessageFormat}}" />
                            </div>
                            <button type="button" class="btn btn-default" id="update_base" onclick="updateConfigBase();">
                                <span class="glyphicon glyphicon-floppy-disk"></span>
                                更新
                            </button>
                            <a href="/admin/config" class="btn btn-default">
                                <span class="glyphicon glyphicon-arrow-left"></span>
                                返回
                            </a>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="alert2"></div>
                        <div class="panel-heading">
                            <h3 class="panel-title">http配置</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="enable" class="form-check-label" >enable：</label>
                                <input type="checkbox" name="enable" id="http_enable" class="form-check-input" {{if getConf.HttpConfig.Enabled }} checked {{end}}/>
                            </div>
                            <div class="form-group">
                                <label for="http_host">host：</label> <input type="text"
                                                                           name="host" id="http_host" class="form-control" value="{{getConf.HttpConfig.Host}}" />
                            </div>
                            <div class="form-group">
                                <label for="http_port">port：</label> <input type="text"
                                                                           name="port" id="http_port" class="form-control" value="{{getConf.HttpConfig.Port}}" />
                            </div>
                            <div class="form-group">
                                <label for="timeout">timeout：</label> <input type="text"
                                                                           name="timeout" id="http_timeout" class="form-control" value="{{getConf.HttpConfig.Timeout}}" />
                            </div>
                            <div class="form-group">
                                <label for="post_url">post_url：</label> <input type="text"
                                                                           name="post_url" id="post_url" class="form-control" value="{{.post}}"  />
                            </div>
                            <div class="form-group">
                                <label for="post_secret">post_secret：</label> <input type="text"
                                                                                 name="post_secret" id="post_secret" class="form-control" value="{{.secret}}"  />
                            </div>
                            <button type="submit" class="btn btn-default" onclick="updateConfigHttp();">
                                <span class="glyphicon glyphicon-floppy-disk"></span>
                                更新
                            </button>
                            <a href="/user/list" class="btn btn-default">
                                <span class="glyphicon glyphicon-arrow-left"></span>
                                返回
                            </a>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="alert3"></div>
                        <div class="panel-heading">
                            <h3 class="panel-title">ws_config</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="enable" class="form-check-label" >enable：</label>
                                <input type="checkbox" name="enable" id="ws_enable" class="form-check-input" {{if getConf.WSConfig.Enabled }} checked {{end}}/>
                            </div>
                            <div class="form-group">
                                <label for="ws_host">host：</label> <input type="text"
                                                                       name="host" id="ws_host" class="form-control" value="{{getConf.WSConfig.Host}}" />
                            </div>
                            <div class="form-group">
                                <label for="ws_port">port：</label> <input type="text"
                                                                       name="port" id="ws_port" class="form-control" value="{{getConf.WSConfig.Port}}" />
                            </div>
                            <button type="submit" class="btn btn-default" onclick="updateConfigWs();">
                                <span class="glyphicon glyphicon-floppy-disk"></span>
                                更新
                            </button>
                            <a href="/user/list" class="btn btn-default">
                                <span class="glyphicon glyphicon-arrow-left"></span>
                                返回
                            </a>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="alert4"></div>
                        <div class="panel-heading">
                            <h3 class="panel-title">ws_反向</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="reverse_enable" class="form-check-label" >enable：</label>
                                <input type="checkbox" name="enable" id="reverse_enable" class="form-check-input" {{if .ReverseServers.Enabled }} checked {{end}}/>
                            </div>
                            <div class="form-group">
                                <label for="reverse_url">reverse_url：</label> <input type="text"
                                                                       name="reverse_url" id="reverse_url" class="form-control" value="{{.ReverseServers.ReverseUrl}}" />
                            </div>
                            <div class="form-group">
                                <label for="reverse_api_url">reverse_api_url：</label> <input type="text"
                                                                       name="reverse_api_url" id="reverse_api_url" class="form-control" value="{{.ReverseServers.ReverseApiUrl}}" />
                            </div>
                            <div class="form-group">
                                <label for="reverse_event_url">reverse_event_url：</label> <input type="text"
                                                                       name="reverse_event_url" id="reverse_event_url" class="form-control" value="{{.ReverseServers.ReverseEventUrl}}" />
                            </div>
                            <div class="form-group">
                                <label for="reverse_reconnect_interval">reverse_reconnect_interval：</label> <input type="text"
                                                                       name="reverse_reconnect_interval" id="reverse_reconnect_interval" class="form-control" value="{{.ReverseServers.ReverseReconnectInterval}}" />
                            </div>
                            <button type="submit" class="btn btn-default" onclick="updateConfigReverse();">
                                <span class="glyphicon glyphicon-floppy-disk"></span>
                                更新
                            </button>
                            <a href="/user/list" class="btn btn-default">
                                <span class="glyphicon glyphicon-arrow-left"></span>
                                返回
                            </a>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- /.row --><!-- END PROGRESS BARS -->
    </section>
    <!-- /.content -->
</div><!-- /.content-wrapper -->

<script>
    function updateConfigBase() {
        $.ajax({
            type: "POST",
            url: "/admin/do_config_base",
            data:{
                "uin":$("#uin").val(),
                "password":$("#password").val(),
                "enable_db":$("#enable_db").is(':checked'),
                "access_token":$("#access_token").val(),
            },
            dataType: "json",
            success: function (data) {
                console.log(data);
                $(".alert1").html(data.msg).addClass("alert-warning").show().delay(5400).fadeOut();
            },
            error: function (jqXHR) {
                console.log(jqXHR.status);
                $(".alert1").html("httpcode:"+jqXHR.status).addClass("alert-error").show().delay(5400).fadeOut();
            }
        })
    }
    function updateConfigHttp() {
        $.ajax({
            type: "POST",
            url: "/admin/do_config_http",
            data:{
                "enable":$("#http_enable").is(':checked'),
                "host":$("#http_host").val(),
                "port":$("#http_port").val(),
                "timeout":$("#http_timeout").val(),
                "post_url":$("#post_url").val(),
                "post_secret":$("#post_secret").val(),
            },
            dataType: "json",
            success: function (data) {
                console.log(data);
                $(".alert2").html(data.msg).addClass("alert-warning").show().delay(5400).fadeOut();
            },
            error: function (jqXHR) {
                console.log(jqXHR.status);
                $(".alert2").html("httpcode:"+jqXHR.status).addClass("alert-error").show().delay(5400).fadeOut();
            }
        })
    }
    function updateConfigWs() {
        $.ajax({
            type: "POST",
            url: "/admin/do_config_ws",
            data:{
                "enable":$("#ws_enable").is(':checked'),
                "host":$("#ws_host").val(),
                "port":$("#ws_port").val(),
            },
            dataType: "json",
            success: function (data) {
                console.log(data);
                $(".alert3").html(data.msg).addClass("alert-warning").show().delay(5400).fadeOut();
            },
            error: function (jqXHR) {
                console.log(jqXHR.status);
                $(".alert3").html("httpcode:"+jqXHR.status).addClass("alert-error").show().delay(5400).fadeOut();
            }
        })
    }

    function updateConfigReverse() {
        $.ajax({
            type: "POST",
            url: "/admin/do_config_reverse",
            data:{
                "enable":$("#reverse_enable").is(':checked'),
                "reverse_api_url":$("#reverse_api_url").val(),
                "reverse_url":$("#reverse_url").val(),
                "reverse_event_url":$("#reverse_event_url").val(),
                "reverse_reconnect_interval":$("#reverse_reconnect_interval").val(),
            },
            dataType: "json",
            success: function (data) {
                console.log(data);
                $(".alert4").html(data.msg).addClass("alert-warning").show().delay(5400).fadeOut();
            },
            error: function (jqXHR) {
                console.log(jqXHR.status);
                $(".alert4").html("httpcode:"+jqXHR.status).addClass("alert-error").show().delay(5400).fadeOut();
            }
        })
    }
</script>


{{ template "admin/footer.html"}}